<!doctype html><html lang=en-us><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="IE=edge"><link rel=apple-touch-icon sizes=180x180 href=/images/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/images/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/images/favicon-16x16.png><link rel=manifest href=/images/site.webmanifest><title>Week 9 - Introduction to Oracle</title><meta name=description content="2019 Humber Database Course"><meta name=author content="Simon Borer"><link rel=stylesheet href=https://www.dbcourse2019.com/sass/main.min.8c979db45f6c4a880676571cd900fb6665fb828ec1582d7a5f93855fa4647a24.css><link rel=stylesheet href=/css/codemirror.css></head><body><main class=post><article><div class="hero hero--page" style=background-image:url(/images/2019.png)><nav class=page-nav><a class="button small primary page-nav__link" href=https://www.dbcourse2019.com>Home</a>
<a class="button small primary page-nav__link" href=/slides//posts/the-9th-week/>Slides</a></nav><h1 class=page-title>Week 9 - Introduction to Oracle</h1></div><div class=grid-container><div class=grid-x><div class="cell large-6 large-offset-3 medium-10 medium-offset-1"><section><div class=grid-x><div class="cell large-6 large-offset-3 medium-10 medium-offset-1"><p>I've been warned against giving you a shallow knowledge of many subjects.</p><p>Instead, today I'll give you an <em>extremely</em> shallow understanding.</p></div></div></section><section id=2018><div class=grid-x><div class="cell large-6 large-offset-3 medium-10 medium-offset-1"><h2 class=h2>The state of the <code>UNION</code></h2><h3 class=h3>-- Databases in 2018 --</h3></div></div></section><section><div class=grid-x><div class="cell large-6 large-offset-3 medium-10 medium-offset-1"><p>In 2018, the #1 most common database management system is Oracle<sup><a href=https://db-engines.com/en/ranking>1</a></sup>.</p><p>MySQL is the DBMS used by most developers<sup><a href=https://insights.stackoverflow.com/survey/2018#technology-databases>2</a></sup>.</p><p>Postgres gained the most market share since last year<sup><a href=https://insights.stackoverflow.com/survey/2017#technology-databases>3</a></sup>, and is now the #3 DBMS overall.</p></div></div></section><section><div class=grid-x><div class="cell large-6 large-offset-3 medium-10 medium-offset-1"><p>NoSQL ("Not only SQL") databases tried to offer an alternative to relational database architecture by using key/value stores, documents (i.e. JSON) or other "flat" architectures instead of tables. While this was a strong industry trend for a few years, in 2017 and 2018 adoption flattened or fell slightly.</p><p>The consensus seems to be that NoSQL is a good supplemental tool for vertical scalability and rapid iteration, rather than a replacement for relational databases.</p></div></div></section><section><div class=grid-x><div class="cell large-6 large-offset-3 medium-10 medium-offset-1"><p>For example, if you think your data structures will change while you're working on a project, and you're not sure <em>how</em> they will change, a document-based NoSQL db might be a good choice.</p><p>If your primary concern is high-speed caching of data, a key-value store db like Redis might be the best choice.</p><p>If you're dealing with huge chunks of inconsistently structured data, you might need a column-store db like Cassandra.</p><p>If you're dealing more with relationships than data, you might want a graph-based db like Neo4J.</p></div></div></section><section id=MySQL><div class=grid-x><div class="cell large-6 large-offset-3 medium-10 medium-offset-1"><h2 class=h2>MySQL</h2><p>If you haven't already, install <a target=_blank href=https://www.mamp.info/en/downloads/>MAMP</a>.</p></div></div></section><section><div class=grid-x><div class="cell large-6 large-offset-3 medium-10 medium-offset-1"><p>Once you have MAMP installed, run the application and go to <a href=http://localhost:8888/phpMyAdmin/server_sql.php>phpMyAdmin</a>.</p><p>You now have a local development server!</p><p>Try running a command like you would in SQLDeveloper:</p><pre><code class=language-sql>CREATE TABLE locations (
    location_id    NUMBER(4)    PRIMARY KEY,
    address        VARCHAR2(40)
);</code></pre><p><span role=image aria-label=collision>ðŸ’¥</span>This is going to produce errors<span role=image aria-label=collision>ðŸ’¥</span></p></div></div></section><section><div class=grid-x><div class="cell large-6 large-offset-3 medium-10 medium-offset-1"><p>If you run the <code>CREATE TABLE</code> command, you should see <code>No database selected</code> and <code>Unrecognized data type</code> errors.</p><p>We can resolve the former with</p><pre><code class=language-sql>CREATE DATABASE my_database</code></pre><p>... and then prefixing the table name with the db name, as</p><pre><code class=language-sql>CREATE TABLE my_database.locations ();</code></pre></div></div></section><section><div class=grid-x><div class="cell large-6 large-offset-3 medium-10 medium-offset-1"><p>To resolve the <code>Unrecognized data type</code> errors, we'll need to learn about MySQL data types, which are similar to Oracle data types, but with different names.</p><table><thead><tr><th colspan=2>Data type analogues</th></tr><tr><th>Oracle</th><th>MySQL</th></tr></thead><tbody><tr><td><code>VARCHAR2</code></td><td><code>VARCHAR</code></td></tr><tr><td><code>NUMBER</code></td><td><code>INT</code> or <code>DECIMAL</code></td></tr><tr><td><code>DATE</code></td><td><code>DATETIME</code></td></tr></tbody></table></div></div></section><section><div class=grid-x><div class="cell large-6 large-offset-3 medium-10 medium-offset-1"><p>MySQL, like Oracle, has a lot of data types that provide more granularity within these general data types. Check out more <a href=https://dev.mysql.com/doc/refman/8.0/en/data-types.html>in their docs</a>.</p></div></div></section><section><div class=grid-x><div class="cell large-6 large-offset-3 medium-10 medium-offset-1"><p>Run the following:</p><pre><code class=language-sql>CREATE TABLE my_database.locations (
    location_id    INT(4)    PRIMARY KEY,
    address        VARCHAR(40)
);
INSERT INTO my_database.locations VALUES (1, '123 Fake St.');</code></pre></div></div></section><section><div class=grid-x><div class="cell large-6 large-offset-3 medium-10 medium-offset-1"><p>Now try...</p><pre><code class=language-sql>SELECT * FROM my_db.locations</code></pre></div></div></section><section><div class=grid-x><div class="cell large-6 large-offset-3 medium-10 medium-offset-1"><p>Queries in MySQL are virtually the same as they are in Oracle, aside from a few of the data types.</p><p>We will notice some differences in our blocks of code, but these tend to be minor. For example: <code>ELSIF</code> in Oracle would be written as <code>ELSEIF</code> in MySQL.</p></div></div></section><section><div class=grid-x><div class="cell large-6 large-offset-3 medium-10 medium-offset-1"><p>In MySQL, stored procedures and functions are called 'routines'.</p><p>They are kinda clunky.</p><pre><code class=language-sql>CREATE FUNCTION hello (s CHAR(20))
    RETURNS CHAR(50) DETERMINISTIC
    RETURN CONCAT('Hello, ',s,'!');

  SELECT hello('world');</code></pre></div></div></section><section><div class=grid-x><div class="cell large-6 large-offset-3 medium-10 medium-offset-1"><p>But if I showed you this:</p><pre><code class="language-sql no-max">CREATE PROCEDURE get_customer_level(
    IN  customer_number_param INT(11), 
    OUT customer_level_param  VARCHAR(10))
BEGIN
    DECLARE credit_limit_var DOUBLE;
 
    SELECT credit_limit INTO credit_limit_var
    FROM customers
    WHERE customer_number = customer_number_param;
 
    IF credit_limit_var > 50000 THEN
 SET customer_level_param = 'PLATINUM';
    ELSEIF (credit_limit_var <= 50000 AND credit_limit_var >= 10000) THEN
        SET customer_level_param = 'GOLD';
    ELSEIF credit_limit_var < 10000 THEN
        SET customer_level_param = 'SILVER';
    END IF;
 
END</code></pre><p>...I think you could figure it out pretty quickly.</p></div></div></section><section id=acid><div class=grid-x><div class="cell large-6 large-offset-3 medium-10 medium-offset-1"><h2 class=h2>ACID compliance</h2><p>One thing to note about MySQL is that it is <em>not</em> ACID compliant by default. What does that mean, and why should we care?</p><p>ACID is an acronym for what database nerds, as far back as <a href="https://dl.acm.org/citation.cfm?doid=289.291" target=_blank>1983</a>, have agreed are important standards for a database management system.</p></div></div></section><section><div class=grid-x><div class="cell large-6 large-offset-3 medium-10 medium-offset-1"><p><strong>A</strong> stands for Atomicity, which means that if one statement in a transaction fails, the whole transaction fails. If you try to insert a hundred rows, and one of your inserts is missing a closing bracket, the whole script fails.</p><p><strong>C</strong> stands for Consistency, meaning that any data that breaks a rule (think data types and other constraints) is not allowed.</p><p><strong>I</strong> stands for Isolation. That means that even if transactions run at the same time, you get the same result as if you'd run them in order.</p><p><strong>D</strong> stands for Durability, meaning that after you've committed to the db, the power can out and no data will be lost. That means writing to 'non-volatile' memory (i.e. something besides RAM).</p></div></div></section><section><div class=grid-x><div class="cell large-6 large-offset-3 medium-10 medium-offset-1"><p>MySQL falls short particularly with <strong>D</strong>. But does that matter for most web projects? Simply put: no.</p></div></div></section><section id=postgres><div class=grid-x><div class="cell large-6 large-offset-3 medium-10 medium-offset-1"><h2 class=h2>Postgres</h2><p>ACID compliance bragging rights <em>do</em> go to Postgres, however. Postgres is the somewhat more mature, dependable older sibling to MySQL, and its robust feature set and dependability have made it the fastest growing DBMS the past two years in a row.</p><p>It's got great support for JSON, impressive features like table partitioning, and cool data types like Money, Geometry, IP addresses, JSON, and data ranges.</p><p>Let's try it out!</p></div></div></section><section><div class=grid-x><div class="cell large-6 large-offset-3 medium-10 medium-offset-1"><p>If you're on a Windows machine, I have no idea if this will work. Postgres is the default DBMS on Mac OS Servers, and is build with Mac OS in mind. That said, try running the <a href=https://www.enterprisedb.com/downloads/postgres-postgresql-downloads>Windows installer</a>.</p></div></div></section><section><div class=grid-x><div class="cell large-6 large-offset-3 medium-10 medium-offset-1"><p>If you're on Mac, and you <em>don't</em> have homebrew installed already, you're going to want it. It's a handy package manager that's going to crop up a lot during your work.</p><p>That said, if these installation instructions don't work out for your, you can always <a href=https://postgresapp.com/>install the app</a>. But where's the fun in that?</p><p>You can install homebrew on Mac by copying and pasting this command in your terminal:<pre><code>/usr/bin/ruby -e "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/master/install)"</code></pre></p></div></div></section><section><div class=grid-x><div class="cell large-6 large-offset-3 medium-10 medium-offset-1"><p>Once that's done, it's as easy as <code>brew install postgresql</code>.</p><p>When the command has finished running, you can start the service with <code>pg_ctl -D /usr/local/var/postgres start && brew services start postgresql</code>.</p><p>Check to see what your user name is: <code>psql postgres</code>, then <code>\du</code></p></div></div></section><section><div class=grid-x><div class="cell large-6 large-offset-3 medium-10 medium-offset-1"><p>At this point, we've got the DBMS running on our local machine, but unlike when we installed MAMP, we don't have a default server and web interface.</p><p>My understanding is that the stock GUI for postgres, pgAdmin 4, is not good.</p><p>Luckily, there's a pretty great free DB GUI that handles postgres (as well as a number of other DBMSs) called <a href=https://dbeaver.io/ target=_blank>DBeaver</a>. Homebrew users can run <code>brew cask install dbeaver-community.</code></p></div></div></section><section><div class=grid-x><div class="cell large-6 large-offset-3 medium-10 medium-offset-1"><p>You can connect to your Postgres DB by clicking the "plug" icon in the top left.</p><p>Select postgreSQL, and then fill out your info: Host/localhost, Port/5432, Database/postgres, User/${user}, and leave the password blank. Test your connection, and if it works, click 'Finish'.</p></div></div></section><section><div class=grid-x><div class="cell large-6 large-offset-3 medium-10 medium-offset-1"><p>Select your connection from the left-hand menu, and run the following:</p><pre><code class=language-sql>create database my_db;
create table my_table (
  my_id INT   primary key,
  my_name VARCHAR,
  my_money  MONEY
);
insert into my_table values (1, 'Simon', 14.50);
select * from my_table;</code></pre></div></div></section><section><div class=grid-x><div class="cell large-6 large-offset-3 medium-10 medium-offset-1"><h2 class=h2>NoSQL</h2></div></div></section><section id=mongo><div class=grid-x><div class="cell large-6 large-offset-3 medium-10 medium-offset-1"><h2 class=h2>MongoDB</h2><p>MongoDB installation can be tedious (although I may have you run Mongo in the future via Docker, so consider <a href=https://www.docker.com/products/docker-desktop target=_blank>installing it</a>), so in the interests of time, let's look at how data is stored in Mongo...</p></div></div></section><section><div class=grid-x><div class="cell large-6 large-offset-3 medium-10 medium-offset-1"><pre class=slide-only><code class=language-json>{
    "_id" : 1,
    "name" : {
        "first" : "John",
        "last" : "Backus"
    },
    "birth" : ISODate("1924-12-03T05:00:00Z"),
    "death" : ISODate("2007-03-17T04:00:00Z"),
    "contribs" : [
        "Fortran",
        "ALGOL",
        "Backus-Naur Form",
        "FP"
    ]
}

{
    "_id" : ObjectId("51df07b094c6acd67e492f41"),
    "name" : {
        "first" : "John",
        "last" : "McCarthy"
    },
    "birth" : ISODate("1927-09-04T04:00:00Z"),
    "death" : ISODate("2011-12-24T05:00:00Z"),
    "contribs" : [
        "Lisp",
        "Artificial Intelligence",
        "ALGOL"
    ]
}</code></pre><pre class=post-only><code class=language-json>{
    "_id" : 1,
    "name" : {
        "first" : "John",
        "last" : "Backus"
    },
    "birth" : ISODate("1924-12-03T05:00:00Z"),
    "death" : ISODate("2007-03-17T04:00:00Z"),
    "contribs" : [
        "Fortran",
        "ALGOL",
        "Backus-Naur Form",
        "FP"
    ],
    "awards" : [
        {
            "award" : "W.W. McDowell Award",
            "year" : 1967,
            "by" : "IEEE Computer Society"
        },
        {
            "award" : "National Medal of Science",
            "year" : 1975,
            "by" : "National Science Foundation"
        },
        {
            "award" : "Turing Award",
            "year" : 1977,
            "by" : "ACM"
        },
        {
            "award" : "Draper Prize",
            "year" : 1993,
            "by" : "National Academy of Engineering"
        }
    ]
}

{
    "_id" : ObjectId("51df07b094c6acd67e492f41"),
    "name" : {
        "first" : "John",
        "last" : "McCarthy"
    },
    "birth" : ISODate("1927-09-04T04:00:00Z"),
    "death" : ISODate("2011-12-24T05:00:00Z"),
    "contribs" : [
        "Lisp",
        "Artificial Intelligence",
        "ALGOL"
    ],
    "awards" : [
        {
            "award" : "Turing Award",
            "year" : 1971,
            "by" : "ACM"
        },
        {
            "award" : "Kyoto Prize",
            "year" : 1988,
            "by" : "Inamori Foundation"
        },
        {
            "award" : "National Medal of Science",
            "year" : 1990,
            "by" : "National Science Foundation"
        }
    ]
}

{
    "_id" : 3,
    "name" : {
        "first" : "Grace",
        "last" : "Hopper"
    },
    "title" : "Rear Admiral",
    "birth" : ISODate("1906-12-09T05:00:00Z"),
    "death" : ISODate("1992-01-01T05:00:00Z"),
    "contribs" : [
        "UNIVAC",
        "compiler",
        "FLOW-MATIC",
        "COBOL"
    ],
    "awards" : [
        {
            "award" : "Computer Sciences Man of the Year",
            "year" : 1969,
            "by" : "Data Processing Management Association"
        },
        {
            "award" : "Distinguished Fellow",
            "year" : 1973,
            "by" : " British Computer Society"
        },
        {
            "award" : "W. W. McDowell Award",
            "year" : 1976,
            "by" : "IEEE Computer Society"
        },
        {
            "award" : "National Medal of Technology",
            "year" : 1991,
            "by" : "United States"
        }
    ]
}

{
    "_id" : 4,
    "name" : {
        "first" : "Kristen",
        "last" : "Nygaard"
    },
    "birth" : ISODate("1926-08-27T04:00:00Z"),
    "death" : ISODate("2002-08-10T04:00:00Z"),
    "contribs" : [
        "OOP",
        "Simula"
    ],
    "awards" : [
        {
            "award" : "Rosing Prize",
            "year" : 1999,
            "by" : "Norwegian Data Association"
        },
        {
            "award" : "Turing Award",
            "year" : 2001,
            "by" : "ACM"
        },
        {
            "award" : "IEEE John von Neumann Medal",
            "year" : 2001,
            "by" : "IEEE"
        }
    ]
}

{
    "_id" : 5,
    "name" : {
        "first" : "Ole-Johan",
        "last" : "Dahl"
    },
    "birth" : ISODate("1931-10-12T04:00:00Z"),
    "death" : ISODate("2002-06-29T04:00:00Z"),
    "contribs" : [
        "OOP",
        "Simula"
    ],
    "awards" : [
        {
            "award" : "Rosing Prize",
            "year" : 1999,
            "by" : "Norwegian Data Association"
        },
        {
            "award" : "Turing Award",
            "year" : 2001,
            "by" : "ACM"
        },
        {
            "award" : "IEEE John von Neumann Medal",
            "year" : 2001,
            "by" : "IEEE"
        }
    ]
}</code></pre><p>Look familiar? It's not SQL, it's JSON.</p></div></div></section><section><div class=grid-x><div class="cell large-6 large-offset-3 medium-10 medium-offset-1"><p>While concepts like table joins don't transfer to NoSQL, basic databased CRUD operations remain. So instead of writing <code class=language-sql>DROP TABLE people</code>, we write <code class=language-javascript>db.people.drop()</code></p></div></div></section><section id=redis><div class=grid-x><div class="cell large-6 large-offset-3 medium-10 medium-offset-1"><h2 class=h2>Redis</h2><p>Redis is a pretty fascinating "in-memory data structure store", meant to be used for really impressive caching. It definitely challenges the notions of what a database is - in some ways it's the <em>opposite</em> of ACID.</p><p>I'll try and give us a sample of Redis soon - I want to run it as a Docker image, but I haven't had time to set that up for us yet.</p></div></div></section><section id=discussion><div class=grid-x><div class="cell large-6 large-offset-3 medium-10 medium-offset-1"><h2 class=h2>Discussion</h2><p>What technology you decide to use can be a factor in whether a project succeeds or fails. Even as a junior developer, you should be able to take part in those discussions, and push back when someone (*ahem* management) starts taking you down the wrong path. It's not about having all the answers, but asking good questions.</p><p>Get in small groups. Talk about what questions might be important when deciding on a database solution.</p></div></div></section><section class=slide-only><div class=grid-x><div class="cell large-6 large-offset-3 medium-10 medium-offset-1"><h2 class=h2>Another discussion</h2></div></div></section><section><div class=grid-x id=lab><div class="cell large-6 large-offset-3 medium-10 medium-offset-1"><h2 class=h2>Assignment time!</h2><p>This week you will be doing some database architecture. Create tables based on the following. Don't feel the need to actually <em>solve</em> any problems listed below, but think about how you might, and design your tables to facilitate that.</p></div></div></section><section><div class=grid-x><div class="cell large-6 large-offset-3 medium-10 medium-offset-1"><p>You run a bakery.</p><p>Your bakery has three locations in the west end of Toronto.</p><p>Your bakery has 2 types of employee - bakers and cashiers.</p><p>Your bakery initially produces 6 types of pasteries, and 4 types of bread. You also serve coffee. You might add more items later on.</p><p>Working with your data, you might need to...</p></div></div></section><section><div class=grid-x><div class="cell large-6 large-offset-3 medium-10 medium-offset-1"><ul><li>create a schedule for your employees, keeping in mind that<ul><li>no employee can work more than 44 hours/week</li><li>no employee can work less than 25 hours/week</li><li>shifts are a minimum of 4 hours, and a maximum of 8</li><li>employees can be scheduled to work at different locations</li><li>cashiers cannot bake, and bakers cannot do cashier duties</li></ul></li></ul></div></div></section><section><div class=grid-x><div class="cell large-6 large-offset-3 medium-10 medium-offset-1"><ul><li>create a menu, factoring in that<ul><li>each week the price of a different item is reduced by 20%</li><li>each week the price of two items are reduced by 10%</li></ul></li><li>evaluate the cost of items including materials and labour, and try to find efficiencies; each type of food or beverage should list the total cost of ingredients; the food should list the baking time, and the bakers' prep time, along with the required baking temperature and the required oven space</li><li>track transactions at the bakery</li></ul></div></div></section><section><div class=grid-x><div class="cell large-6 large-offset-3 medium-10 medium-offset-1"><p>How do you design your database tables?</p><p>Will you be able to...</p><ul><li>write a stored procedure to add a new type of bread?</li><li>write a function to return the menu?</li><li>validate the data so that you can create a new schedule?</li><li>create a baking schedule (keeping in mind that there is limited oven space, varied by location, and that foods with the same baking temperature can share an oven)?</li><li>calculate the cost per unit of different foods (factoring in the labour involved)?</li></ul><p>Also, try thinking about what other metrics could you track/calculate to help the business?</p></div></div></section></div></div></div></article></main><script src=https://www.dbcourse2019.com/js/prism.js></script><script src=https://www.dbcourse2019.com/js/codemirror.js></script><script src=https://www.dbcourse2019.com/js/xml.js></script><script src=https://www.dbcourse2019.com/js/css.js></script><script src=https://www.dbcourse2019.com/js/javascript.js></script><script src=https://www.dbcourse2019.com/js/htmlmixed.js></script><script src=https://www.dbcourse2019.com/js/sql.js></script><script type=text/javascript>function qsa(sel){return Array.apply(null,document.querySelectorAll(sel));}
qsa('[data-code-mirror="html"]').forEach(function(editorEl){var mirror=CodeMirror.fromTextArea(editorEl,{lineNumbers:true,mode:'htmlmixed',theme:'material'});if(editorEl.hasAttribute("data-code-mirror-height")){var setHeight=editorEl.getAttribute("data-code-mirror-height");mirror.setSize(null,setHeight);}});qsa('[data-code-mirror="sql"]').forEach(function(editorEl){var mirror=CodeMirror.fromTextArea(editorEl,{lineNumbers:true,mode:'sql',theme:'material'});if(editorEl.hasAttribute("data-code-mirror-height")){var setHeight=editorEl.getAttribute("data-code-mirror-height");mirror.setSize(null,setHeight);}});</script></body></html>